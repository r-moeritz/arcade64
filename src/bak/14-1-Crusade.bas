100 POKE56,53:POKE55,128:clr
110 GOSUB1290
120 GOSUB1340
130 GOSUB990
140 :
150 POKEV0,SX:POKEV1,SY
160 A=PEEK(V4)+PEEK(V5):IF(PEEK(V4)ANDZ1)+(PEEK(V5
^ )ANDZ1)THEN860 :rem 97
170 GETA$:IFA$=""THEN230 :rem 80
r^ 180 IFA$="{F1}IITHENPOKE53269,0:GOTO120 :rem 92
r ' 190 IFA$o"{F7}IITHEN230 :rem 152
200 T$=TI$ :rem 8
f> 210 GETA$:IFA$=IIMTHEN210 : rem 73
220 TI$=T$ :rem 10
O 230 K=ZB-PEEK(JS):IFK=Z0THEN330 :rem 153
240 IFKANDZATHEN500 :rem 162
^ 250 IFKANDZ1THENSY=SY-Z4:GOTO270 :rem 90
260 IFKANDZ2THENSY=SY+Z4 :rem 78
/~k 270 IF(KANDZ4)=Z0THEN300 :rem 174
280 SX=SX-Z4:IFDR=Z0THENSX=SX-Z6:POKEV0,SXANDZD:DR
^ =Z4 :rem 95
^ 290 GOTO320 :rem 105
300 IF(KANDZ8)=Z0THEN320 :rem 174
O 310 SX=SX+Z4:IFDR=Z4THENSX=SX+Z6:POKEV0,SXANDZD:DR
=Z0 :rem 85
O 320 POKEPN,SB+WK+DR:WK=(WK+Z1)ANDZ3 :rem 211
330 I=PEEK(V2):IFSX>ZDTHENSX=SX-ZE:I=I0RZl:P0KEV2#
^ I:POKEV0#SX :rem 89
340 IFSX<Z0THENSX=SX+ZE:I=IANDZC:P0KEV2,I:POKEV0,S
**. X :rem 200
^ 350 IFSY<M0ORSY>M1OR(SX<M2AND(IANDZ1)=Z0)OR(SX>M3A
ND(IANDZ1))THEN580 :rem 113
<i 360 IFLRTHENLR=LR+l+15*(LR>14):POKE53294,LR:rem 81
370 POKE14223+BL#72:BL=BL+3:IFBL>6THENBL=0:rem 249
O 380 POKE14223+BL.75 :rem 23
390 FORI=Z2TO12STEPZ2:IFAL%(RM,I/Z2)=Z0THEN440
^ :rem 140
400 J=PEEK(V0+I):J=J+SR*SGN((PEEK(V2)ANDZ1)* ZE+SXf-
s J):K=PEEK(V1+I) :rem 191
410 K=K+SR*SGN(SY-K) :rem 191
^^ 420 IFJ<ZEANDJ>M2THENPOKEV0+I,J :rem 242
(^ 430 IFK<M1ANDK>M0THENPOKEV1+I,K :rem 212
440 NEXT:IFPEEK(V4)ANDZ1THEN860 irem 203
(~*) 450 IFPEEK(V4)+PEEK(V5)=Z0THEN150